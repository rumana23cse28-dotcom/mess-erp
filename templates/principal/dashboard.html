{% extends "base.html" %}

{% block content %}

<h3 class="mb-4">Principal Dashboard</h3>

<!-- TOP STATS -->
<div class="row mb-4">

  <div class="col-md-4">
    <div class="card p-3 shadow-sm">
      <h5>Total Inventory Items</h5>
      <p class="fs-4 text-primary">{{ total_items }}</p>
    </div>
  </div>

  <div class="col-md-4">
    <div class="card p-3 shadow-sm">
      <h5>Low Stock Alerts</h5>
      <p class="fs-4 text-danger">{{ low_stock }}</p>
    </div>
  </div>

  <div class="col-md-4">
    <div class="card p-3 shadow-sm">
      <h5>Quick Actions</h5>
      <a href="/inventory" class="btn btn-sm btn-success mt-2">
        Manage Inventory
      </a>
    </div>
  </div>

</div>

<!-- SECOND ROW -->
<div class="row mb-4">

  <div class="col-md-4">
    <div class="card p-3 shadow-sm">
      <h5>Average Attendance</h5>
      <p class="fs-6 text-success">Live Attendance Data</p>
      <a href="/attendance/summary" class="btn btn-sm btn-primary">
        View Summary
      </a>
    </div>
  </div>

  <div class="col-md-4">
    <div class="card p-3 shadow-sm">
      <h5>Payment Status</h5>
      <p class="fs-6">Paid vs Due Bills</p>
      <a href="#billChart" class="btn btn-sm btn-warning mt-2">
        View Chart Below
      </a>
    </div>
  </div>

</div>

<hr class="my-4">

<!-- BILL CHART -->
<h4 class="mb-3">Mess Bill Status</h4>

<div class="row">
  <div class="col-md-5">
    <div class="card p-3 shadow-sm text-center">
      <canvas id="billChart"></canvas>
    </div>
  </div>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
const ctx = document.getElementById('billChart');

new Chart(ctx, {
  type: 'doughnut',
  data: {
    labels: ['Paid', 'Due'],
    datasets: [{
      data: [{{ paid }}, {{ due }}],
      backgroundColor: ['#28a745', '#dc3545']
    }]
  },
  options: {
    plugins: {
      legend: {
        position: 'bottom'
      }
    }
  }
});
</script>

{% endblock %}
